# dropbox-clone/Makefile1

CC = gcc
CFLAGS = -Wall -g -pthread

TARGET = server
CLIENT = client
FILE_CLIENT = client_file_testing

SRC_DIR = src

all: $(TARGET) $(CLIENT) $(FILE_CLIENT)

$(TARGET): $(SRC_DIR)/main.c $(SRC_DIR)/client_threadpool.c $(SRC_DIR)/commands.c
	$(CC) $(CFLAGS) -o $(TARGET) $(SRC_DIR)/main.c $(SRC_DIR)/client_threadpool.c $(SRC_DIR)/commands.c

$(CLIENT): $(SRC_DIR)/client.c
	$(CC) $(CFLAGS) -o $(CLIENT) $(SRC_DIR)/client.c

$(FILE_CLIENT): $(SRC_DIR)/client_file_testing.c
	$(CC) $(CFLAGS) -o $(FILE_CLIENT) $(SRC_DIR)/client_file_testing.c

clean:
	rm -f $(TARGET) $(CLIENT) $(FILE_CLIENT) *.o *~

test:
	@echo "Starting server test..."
	./$(TARGET)
	@echo "Server started. Run ./$(CLIENT) or ./$(FILE_CLIENT) manually to test, then press Ctrl+C to stop server."
	@echo "Test completed when you manually stop the server."

.PHONY: all clean test
